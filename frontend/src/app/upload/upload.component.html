<div class="immersive-page">
  
  <!-- HERO SECTION: Full-screen 3D brain background -->
  <section class="hero-section">
    <div class="brain-background">
      <app-brain3d [diagnosis]="result?.prediction || 'Normal'"></app-brain3d>
    </div>
    
    <div class="hero-gradient"></div>
    
    <div class="hero-content">
      <div class="content-wrapper">
        <p class="category-label">AI-Powered Cognitive Analysis</p>
        <h1 class="main-title">
          <span class="title-line">Alzheimer MRI</span>
          <span class="title-line">Detection</span>
        </h1>
        <p class="subtitle">Explore interactive 3D brain visualization powered by deep learning</p>
        
        <div class="upload-controls">
          <label class="upload-button">
            <input type="file" (change)="onFileSelected($event)" accept="image/*">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
            </svg>
            <span>{{ selectedFile?.name || 'Select MRI Image' }}</span>
          </label>
          
          <button class="analyze-button" (click)="onSubmit()" [disabled]="loading || !selectedFile">
            <span *ngIf="!loading">Analyze Brain Scan</span>
            <span *ngIf="loading" class="loading-text">
              <span class="spinner"></span>
              Analyzing...
            </span>
          </button>
        </div>
        
        <p class="file-hint" *ngIf="!selectedFile && !loading">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
            <circle cx="12" cy="12" r="10"/>
            <path d="M12 8v4M12 16h.01" stroke="#0a0e1a" stroke-width="2"/>
          </svg>
          Supported formats: JPG, PNG, JPEG
        </p>
        <p class="error-message" *ngIf="errorMessage">âš  {{ errorMessage }}</p>
      </div>
    </div>
    
    <div class="scroll-indicator" *ngIf="result">
      <span>Scroll to view results</span>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 5v14M19 12l-7 7-7-7"/>
      </svg>
    </div>
  </section>
  
  <!-- RESULTS SECTION: Glassmorphic cards with data visualization -->
  <section class="results-section" *ngIf="result">
    <div class="results-container">
      
      <!-- Debug info (remove in production) -->
      <div class="debug-info" style="display: none;">
        <pre>{{ result | json }}</pre>
      </div>
      
      <!-- Prediction Card -->
      <div class="glass-card prediction-card">
        <div class="card-header">
          <div class="header-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
            </svg>
          </div>
          <div>
            <p class="card-label">Diagnosis</p>
            <h2 class="diagnosis-result">{{ result.prediction || 'No prediction available' }}</h2>
          </div>
        </div>
        
        <div class="confidence-badge">
          <div>
            <span class="badge-label">Confidence Score</span>
            <span class="confidence-value">{{ result.confidence || 0 }}%</span>
          </div>
          <div class="confidence-ring">
            <svg width="80" height="80" viewBox="0 0 80 80">
              <circle cx="40" cy="40" r="36" fill="none" stroke="rgba(0, 255, 255, 0.15)" stroke-width="4"/>
              <circle cx="40" cy="40" r="36" fill="none" stroke="url(#gradient)" stroke-width="4"
                      [attr.stroke-dasharray]="226" 
                      [attr.stroke-dashoffset]="226 - (226 * (result.confidence || 0) / 100)"
                      transform="rotate(-90 40 40)"/>
              <defs>
                <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                  <stop offset="0%" stop-color="#00ffff"/>
                  <stop offset="50%" stop-color="#ff00ff"/>
                  <stop offset="100%" stop-color="#00ccff"/>
                </linearGradient>
              </defs>
            </svg>
          </div>
        </div>
      </div>
      
      <!-- Probabilities Card -->
      <div class="glass-card probabilities-card" *ngIf="result?.probabilities && (result?.probabilities | keyvalue)?.length! > 0">
        <div class="card-title">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"/>
            <rect x="14" y="3" width="7" height="7"/>
            <rect x="14" y="14" width="7" height="7"/>
            <rect x="3" y="14" width="7" height="7"/>
          </svg>
          <h3>Class Probabilities</h3>
        </div>
        
        <div class="probability-list">
          <div class="probability-item" *ngFor="let p of result.probabilities | keyvalue; let i = index" 
               [style.animation-delay]="(i * 0.1) + 's'">
            <div class="prob-header">
              <span class="prob-label">{{ p.key }}</span>
              <span class="prob-percentage">{{ p.value || 0 }}%</span>
            </div>
            <div class="prob-bar-container">
              <div class="prob-bar-bg">
                <div class="prob-bar-fill" [style.width.%]="p.value || 0"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- MRI Image Card - Premium Design -->
      <div class="glass-card image-card" *ngIf="result.imagePreview">
        <div class="card-header-image">
          <div class="header-icon-image">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2"/>
              <circle cx="8.5" cy="8.5" r="1.5"/>
              <path d="m21 15-5-5L5 21"/>
            </svg>
          </div>
          <div>
            <p class="card-label-image">Medical Imaging</p>
            <h3 class="image-title">MRI Brain Scan</h3>
          </div>
        </div>
        
        <div class="image-frame-wrapper">
          <div class="image-frame">
            <div class="frame-glow"></div>
            <div class="frame-border">
              <div class="corner corner-tl"></div>
              <div class="corner corner-tr"></div>
              <div class="corner corner-bl"></div>
              <div class="corner corner-br"></div>
              <img [src]="result.imagePreview" alt="Uploaded MRI scan" class="mri-image"/>
            </div>
          </div>
        </div>
        
        <div class="image-footer">
          <div class="scan-info">
            <span class="scan-badge">Professional Quality</span>
            <span class="scan-type">Neuroimaging</span>
          </div>
        </div>
      </div>
      
    </div>
  </section>
  
</div>
